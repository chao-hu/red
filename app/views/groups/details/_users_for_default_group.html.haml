
= panel_item t("common.user"), :user do
  = link_to fa_icon(:plus) + " " + t("group.new_group_user"), "#newUser", class: 'btn btn-primary btn-sm pull-right', data: { toggle: 'modal' }
  = modal_dialog id: "newUser", header: { show_close: true, dismiss: 'modal', title: t('user.new_user') }, body:   { content: render(:partial => "users/form", locals: { group: @group, user: @group.users.new, siteadmin_require: true, groupadmin_require: false }) }, footer: { content: '' }

  %table.table.table-bordered.table-striped.table-hover
    %thead.text-center
      %th= t("user.role")
      %th= t("user.name")
      %th= t("user.email")
      %th= t("user.groups")
      %th= t("common.service")
      %th= t("common.quota")
      %th

    - group.users.order_by_role.each do |user|
      - if user.persisted?
        %tr
          %td= t("user.#{group.group_users.where(user_id: user.id).first.role}")
          %td= user.display
          %td= user.email
          %td
            - user.groups_without_default.order('created_at ASC').each do |g|
              = link_to g.name, group_path(g)
          %td= user.services.length
          %td
            20 core
            2040 M
          %td
            = drop_down_menu :default, t("common.actions") do
              = drop_down_menu_item t("common.edit"), edit_user_path(user)
              = drop_down_menu_item t("common.remove"), leave_group_user_path(group, user), data: { confirm: t("common.remove") }
              = drop_down_menu_item fa_icon(:trash) + "  " + t("common.delete_user"), group_user_path(group, user), data: { confirm: t("common.remove") }, method: :delete

